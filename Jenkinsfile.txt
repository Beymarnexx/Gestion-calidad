pipeline {
    agent any

    tools {
        maven 'Maven 3.8.1' // Asegúrate de que esta versión esté instalada en Jenkins
    }

    environment {
        DEPLOY_USER = 'usuario' // Reemplaza con tu usuario SSH
        DEPLOY_HOST = '192.168.1.100' // Reemplaza con la IP o dominio de tu servidor
        DEPLOY_PATH = '/var/www/produccion' // Ruta de despliegue en el servidor
    }

    stages {
        stage('Clonar Repositorio') {
            steps {
                git branch: 'main',
                    url: 'https://github.com/Beymarnexx/Gestion-calidad.git'
            }
        }

        stage('Construir Proyecto') {
            steps {
                dir('PRODUCCION') {
                    sh 'mvn clean package'
                }
            }
        }

        stage('Desplegar Artefacto') {
            steps {
                sshagent(['credenciales-ssh']) { // Reemplaza con el ID de tus credenciales SSH en Jenkins
                    sh '''
                        scp PRODUCCION/target/*.jar $DEPLOY_USER@$DEPLOY_HOST:$DEPLOY_PATH/
                    '''
                }
            }
        }
    }

    post {
        success {
            echo 'Despliegue completado exitosamente.'
        }
        failure {
            echo 'El despliegue ha fallado.'
        }
    }
}
